        -:    0:Source:/media/huyenbui117/D/AILab/tic-tac-toe/src/controller.cpp
        -:    1:#include <iostream>
        -:    2:#include "tictactoe/render_engine.h"
        -:    3:#include "tictactoe/controller.h"
        -:    4:
function _ZN10Controller12processEventERN2sf5EventE called 0 returned 0% blocks executed 0%
    #####:    5:void Controller::processEvent(sf::Event &event)
        -:    6:{
        -:    7:    // only process quick events in the main thread
        -:    8:    // other heavy events (click & AI) are processed in the event thread
        -:    9:    // these heavy events, which change game state, are added to the event queue
        -:   10:    // so that the event thread processes them one by one
        -:   11:    // keeping the consistency of the game state
    #####:   12:    switch (event.type) {
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
    #####:   13:        case sf::Event::MouseButtonReleased:
    #####:   14:            addEvent(event); // to event thread queue
call    0 never executed
    #####:   15:            break;
    #####:   16:        case sf::Event::Closed:
    #####:   17:            window.close();
call    0 never executed
    #####:   18:            break;
    #####:   19:        case sf::Event::MouseMoved:
    #####:   20:            onMouseMoved(event);
call    0 never executed
    #####:   21:            break;
    #####:   22:        default: break;
        -:   23:    }
    #####:   24:}
        -:   25:
function _ZN10Controller12onMouseMovedERN2sf5EventE called 0 returned 0% blocks executed 0%
    #####:   26:void Controller::onMouseMoved(sf::Event &event)
        -:   27:{
    #####:   28:    if (state.getPlayScreen() == GameState::PlayScreen::PlayModeScreen) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:   29:        sf::Vector2i localPosition = { event.mouseMove.x, event.mouseMove.y};
call    0 never executed
    #####:   30:        checkButtonHovered(localPosition);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:   31:    } else {
    #####:   32:        sf::Vector2i localPosition = { event.mouseMove.x, event.mouseMove.y};
call    0 never executed
    #####:   33:        int i = localPosition.x / GameWindow::CELL_HEIGHT,
    #####:   34:            j = localPosition.y / GameWindow::CELL_WIDTH;
    #####:   35:        window.setHoveredCell(i, j);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:   36:    }
    #####:   37:}
        -:   38:
function _ZN10Controller21onMouseButtonReleasedERN2sf5EventE called 0 returned 0% blocks executed 0%
    #####:   39:void Controller::onMouseButtonReleased(sf::Event &event)
        -:   40:{
    #####:   41:    if (state.getPlayScreen() == GameState::PlayScreen::PlayingScreen)
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:   42:    {
    #####:   43:        if (!state.isGameStop()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:   44:            sf::Vector2i localPosition = { event.mouseButton.x, event.mouseButton.y};
call    0 never executed
    #####:   45:            int i = localPosition.x / GameWindow::CELL_HEIGHT,
    #####:   46:                j = localPosition.y / GameWindow::CELL_WIDTH;
    #####:   47:            state.playAndChangePlayer(i, j);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:   48:        } else { // game is over so reset the game
    #####:   49:            state.resetGame();
call    0 never executed
        -:   50:            // change the play screen to PlayModeScreen
    #####:   51:            state.setPlayScreen(GameState::PlayScreen::PlayModeScreen);
call    0 never executed
        -:   52:        }
        -:   53:    } else { // GameState::PlayScreen::PlayModeScreen
    #####:   54:        sf::Vector2i localPosition = { event.mouseButton.x, event.mouseButton.y};
call    0 never executed
    #####:   55:        checkButtonClicked(localPosition);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:   56:    }
    #####:   57:}
        -:   58:
        -:   59:// check if a button is clicked
function _ZN10Controller18checkButtonClickedEN2sf7Vector2IiEE called 0 returned 0% blocks executed 0%
    #####:   60:void Controller::checkButtonClicked(sf::Vector2i localPosition)
        -:   61:{
    #####:   62:   if (GameWindow::getButtonHvsHRect().contains(localPosition)) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
    #####:   63:        state.setPlayScreen(GameState::PlayScreen::PlayingScreen);
call    0 never executed
    #####:   64:        state.setPlayMode(GameState::PlayMode::HumanVsHuman);
call    0 never executed
    #####:   65:        std::cout << "Human vs Human" << std::endl;
call    0 never executed
call    1 never executed
    #####:   66:    } else if (GameWindow::getButtonHvsMRect().contains(localPosition)) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
    #####:   67:        state.setPlayScreen(GameState::PlayScreen::PlayingScreen);
call    0 never executed
    #####:   68:        state.setPlayMode(GameState::PlayMode::HumanVsMachine);
call    0 never executed
    #####:   69:        std::cout << "Human vs Machine" << std::endl;
call    0 never executed
call    1 never executed
    #####:   70:    } else if (GameWindow::getButtonMvsHRect().contains(localPosition)) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
    #####:   71:        state.setPlayScreen(GameState::PlayScreen::PlayingScreen);
call    0 never executed
    #####:   72:        state.setPlayMode(GameState::PlayMode::HumanVsMachine);
call    0 never executed
    #####:   73:        state.computerPlayFirst();
call    0 never executed
    #####:   74:        std::cout << "Machine vs Human" << std::endl;
call    0 never executed
call    1 never executed
        -:   75:    }
    #####:   76:}
        -:   77:
        -:   78:// check if a button is hovered
function _ZN10Controller18checkButtonHoveredEN2sf7Vector2IiEE called 0 returned 0% blocks executed 0%
    #####:   79:void Controller::checkButtonHovered(sf::Vector2i localPosition)
        -:   80:{
    #####:   81:    window.setHoveredButtons(localPosition);
call    0 never executed
    #####:   82:}
        -:   83:
function _ZN10Controller8addEventEN2sf5EventE called 0 returned 0% blocks executed 0%
    #####:   84:void Controller::addEvent(sf::Event event)
        -:   85:{
    #####:   86:    mutex.lock();
call    0 never executed
    #####:   87:    queue.push(event);
call    0 never executed
    #####:   88:    mutex.unlock();
call    0 never executed
    #####:   89:}
        -:   90:
function _ZN10Controller6launchEv called 0 returned 0% blocks executed 0%
    #####:   91:void Controller::launch() {
    #####:   92:    thread.launch();
call    0 never executed
    #####:   93:}
        -:   94:
function _ZN10Controller4waitEv called 0 returned 0% blocks executed 0%
    #####:   95:void Controller::wait() {
    #####:   96:    thread.wait();
call    0 never executed
    #####:   97:}
        -:   98:
function _ZN10Controller8getEventEv called 0 returned 0% blocks executed 0%
    #####:   99:sf::Event Controller::getEvent()
        -:  100:{
        -:  101:    sf::Event event;
    #####:  102:    event.type = sf::Event::Count;
    #####:  103:    mutex.lock();
call    0 never executed
    #####:  104:    if (!queue.empty()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  105:        event = queue.front();
call    0 never executed
    #####:  106:        queue.pop();
call    0 never executed
        -:  107:    }
    #####:  108:    mutex.unlock();
call    0 never executed
        -:  109:    // std::cout << "event pop " << event.type << " " << queue.size() << std::endl; 
        -:  110:
    #####:  111:    return event;
        -:  112:}
        -:  113:
function _ZN10Controller3runEv called 0 returned 0% blocks executed 0%
    #####:  114:void Controller::run()
        -:  115:{
    #####:  116:    while (window.isOpen()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  117:        sf::Event event = getEvent();
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  118:        switch (event.type) {
branch  0 never executed
branch  1 never executed
    #####:  119:            case sf::Event::MouseButtonReleased:
    #####:  120:                onMouseButtonReleased(event);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  121:                break;
    #####:  122:            default: break;
        -:  123:        }
        -:  124:    }
    #####:  125:}
